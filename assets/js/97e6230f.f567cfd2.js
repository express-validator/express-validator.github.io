"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6760],{3865:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>x,frontMatter:()=>o,metadata:()=>u,toc:()=>h});var s=t(4246),r=t(1670),a=t(3930),i=t(9798),l=t(6989);const o={title:"Getting Started"},d=void 0,u={id:"guides/getting-started",title:"Getting Started",description:"One of the best ways to learn something is by example!",source:"@site/../docs/guides/getting-started.md",sourceDirName:"guides",slug:"/guides/getting-started",permalink:"/docs/next/guides/getting-started",draft:!1,unlisted:!1,editUrl:"https://github.com/express-validator/express-validator/edit/master/docs/../docs/guides/getting-started.md",tags:[],version:"current",frontMatter:{title:"Getting Started"},sidebar:"docs",previous:{title:"Guides",permalink:"/docs/next/category/guides"},next:{title:"The Validation Chain",permalink:"/docs/next/guides/validation-chain"}},c={},h=[{value:"Set up",id:"set-up",level:2},{value:"Adding a validator",id:"adding-a-validator",level:2},{value:"Handling validation errors",id:"handling-validation-errors",level:2},{value:"Sanitizing inputs",id:"sanitizing-inputs",level:2},{value:"Accessing validated data",id:"accessing-validated-data",level:2},{value:"What&#39;s next?",id:"whats-next",level:2}];function p(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"One of the best ways to learn something is by example!\nSo let's roll the sleeves up and get some coding happening."}),"\n",(0,s.jsx)(n.h2,{id:"set-up",children:"Set up"}),"\n",(0,s.jsx)(n.p,{children:"The first thing that one needs is a express.js application running.\nLet's implement one that says hi to someone; for this, create a new file using your favorite language\nand add the following code:"}),"\n",(0,s.jsxs)(a.Z,{groupId:"lang",children:[(0,s.jsx)(i.Z,{value:"js",label:"JavaScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="index.js" showLineNumbers',children:"const express = require('express');\nconst app = express();\n\napp.use(express.json());\napp.get('/hello', (req, res) => {\n  res.send(`Hello, ${req.query.person}!`);\n});\n\napp.listen(3000);\n"})})}),(0,s.jsx)(i.Z,{value:"ts",label:"TypeScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="index.ts" showLineNumbers',children:"import * as express from 'express';\nconst app = express();\n\napp.use(express.json());\napp.get('/hello', (req, res) => {\n  res.send(`Hello, ${req.query.person}!`);\n});\n\napp.listen(3000);\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["Now run this file by executing ",(0,s.jsx)(n.code,{children:"node index.js"})," or ",(0,s.jsx)(n.code,{children:"ts-node index.ts"})," on your terminal.",(0,s.jsx)("br",{}),"\nThe HTTP server should be running, and you can open ",(0,s.jsx)(n.a,{href:"http://localhost:3000/hello?person=John",children:"http://localhost:3000/hello?person=John"}),"\nto salute John!"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["You can use ",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/node-dev",children:"node-dev"})," or ",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/ts-node-dev",children:"ts-node-dev"}),"\nto run your application instead.\nThese automatically restart the application whenever a file is changed, so you don't have to do this yourself!"]})}),"\n",(0,s.jsx)(n.h2,{id:"adding-a-validator",children:"Adding a validator"}),"\n",(0,s.jsxs)(n.p,{children:["So the application is working, but there are problems with it. Most notably, you don't want to\nsay hey when the person's name is not set.",(0,s.jsx)(n.br,{}),"\n","For example, going to ",(0,s.jsx)(n.a,{href:"http://localhost:3000/hello",children:"http://localhost:3000/hello"}),' will print "Hello, undefined!".']}),"\n",(0,s.jsxs)(n.p,{children:["That's where express-validator comes in handy: let's add a ",(0,s.jsx)(n.strong,{children:"validator"})," that checks that the ",(0,s.jsx)(n.code,{children:"person"}),"\nquery string cannot be empty, with the intuitively named validator ",(0,s.jsx)(n.code,{children:"notEmpty"}),":"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"lang",children:[(0,s.jsx)(i.Z,{value:"js",label:"JavaScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="index.js" showLineNumbers',children:"const express = require('express');\n// highlight-next-line\nconst { query } = require('express-validator');\nconst app = express();\n\napp.use(express.json());\n// highlight-next-line\napp.get('/hello', query('person').notEmpty(), (req, res) => {\n  res.send(`Hello, ${req.query.person}!`);\n});\n\napp.listen(3000);\n"})})}),(0,s.jsx)(i.Z,{value:"ts",label:"TypeScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="index.ts" showLineNumbers',children:"import * as express from 'express';\n// highlight-next-line\nimport { query } from 'express-validator';\nconst app = express();\n\napp.use(express.json());\n// highlight-next-line\napp.get('/hello', query('person').notEmpty(), (req, res) => {\n  res.send(`Hello, ${req.query.person}!`);\n});\n\napp.listen(3000);\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["Now, restart your application, and go to ",(0,s.jsx)(n.a,{href:"http://localhost:3000/hello",children:"http://localhost:3000/hello"}),' again.\nHmm, it still prints "Hello, undefined!"... why?']}),"\n",(0,s.jsx)(n.h2,{id:"handling-validation-errors",children:"Handling validation errors"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"express-validator validators do not report validation errors to users automatically"}),".",(0,s.jsx)(n.br,{}),"\n","The reason for this is simple: as you add more validators, or for more fields,\nhow do you want to collect the errors?\nDo you want a list of all errors, only one per field, only one overall...?"]}),"\n",(0,s.jsxs)(n.p,{children:["So the next obvious step is to change the above code again, this time verifying the validation result\nwith the ",(0,s.jsxs)(n.a,{href:"/docs/next/api/validation-result",children:[(0,s.jsx)(n.code,{children:"validationResult"})," function"]}),":"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"lang",children:[(0,s.jsx)(i.Z,{value:"js",label:"JavaScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="index.js" showLineNumbers',children:"const express = require('express');\n// highlight-next-line\nconst { query, validationResult } = require('express-validator');\nconst app = express();\n\napp.use(express.json());\napp.get('/hello', query('person').notEmpty(), (req, res) => {\n  // highlight-start\n  const result = validationResult(req);\n  if (result.isEmpty()) {\n    return res.send(`Hello, ${req.query.person}!`);\n  }\n\n  res.send({ errors: result.array() });\n  // highlight-end\n});\n\napp.listen(3000);\n"})})}),(0,s.jsx)(i.Z,{value:"ts",label:"TypeScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="index.ts" showLineNumbers',children:"import * as express from 'express';\n// highlight-next-line\nimport { query, validationResult } from 'express-validator';\nconst app = express();\n\napp.use(express.json());\napp.get('/hello', query('person').notEmpty(), (req, res) => {\n  // highlight-start\n  const result = validationResult(req);\n  if (result.isEmpty()) {\n    return res.send(`Hello, ${req.query.person}!`);\n  }\n\n  res.send({ errors: result.array() });\n  // highlight-end\n});\n\napp.listen(3000);\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["Now if you access ",(0,s.jsx)(n.a,{href:"http://localhost:3000/hello",children:"http://localhost:3000/hello"})," again, what you'll see\nis the following JSON content:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "errors": [\n    {\n      "location": "query",\n      "msg": "Invalid value",\n      "path": "person",\n      "type": "field"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Now, what this is telling us is that"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"there's been exactly one error in this request;"}),"\n",(0,s.jsxs)(n.li,{children:["the error is in a field (",(0,s.jsx)(n.code,{children:'type: "field"'}),");"]}),"\n",(0,s.jsxs)(n.li,{children:["this field is called ",(0,s.jsx)(n.code,{children:"person"}),";"]}),"\n",(0,s.jsxs)(n.li,{children:["it's located in the query string (",(0,s.jsx)(n.code,{children:'location: "query"'}),");"]}),"\n",(0,s.jsxs)(n.li,{children:["the error message that was given was ",(0,s.jsx)(n.code,{children:"Invalid value"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This is a better scenario, but it can still be improved. Let's continue."}),"\n",(0,s.jsx)(n.h2,{id:"sanitizing-inputs",children:"Sanitizing inputs"}),"\n",(0,s.jsxs)(n.p,{children:["While the user can no longer send empty person names, it can still inject HTML into your page!\nThis is known as the ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Cross-site_scripting",children:"Cross-Site Scripting vulnerability (XSS)"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Let's see how it works. Go to ",(0,s.jsx)(n.a,{href:"http://localhost:3000/hello?person=%3Cb%3EJohn%3C/b%3E",children:(0,s.jsx)(l.Z,{values:{query:"<b>John</b>"},children:"http://localhost:3000/hello?person={query}"})}),',\nand you should see "Hello, ',(0,s.jsx)("b",{children:"John"}),'!".']}),"\n",(0,s.jsxs)(n.p,{children:["While this example is fine, an attacker could change the ",(0,s.jsx)(n.code,{children:"person"})," query string to a ",(0,s.jsx)(n.code,{children:"<script>"})," tag\nwhich loads its own JavaScript that could be harmful."]}),"\n",(0,s.jsxs)(n.p,{children:["In this scenario, one way to mitigate the issue with express-validator is to use a ",(0,s.jsx)(n.strong,{children:"sanitizer"}),",\nmost specifically ",(0,s.jsx)(n.code,{children:"escape"}),", which transforms special HTML characters with others that can be represented\nas text."]}),"\n",(0,s.jsxs)(a.Z,{groupId:"lang",children:[(0,s.jsx)(i.Z,{value:"js",label:"JavaScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="index.js" showLineNumbers',children:"const express = require('express');\nconst { query, validationResult } = require('express-validator');\nconst app = express();\n\napp.use(express.json());\n// highlight-next-line\napp.get('/hello', query('person').notEmpty().escape(), (req, res) => {\n  const result = validationResult(req);\n  if (result.isEmpty()) {\n    return res.send(`Hello, ${req.query.person}!`);\n  }\n\n  res.send({ errors: result.array() });\n});\n\napp.listen(3000);\n"})})}),(0,s.jsx)(i.Z,{value:"ts",label:"TypeScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="index.ts" showLineNumbers',children:"import * as express from 'express';\nimport { query, validationResult } from 'express-validator';\nconst app = express();\n\napp.use(express.json());\n// highlight-next-line\napp.get('/hello', query('person').notEmpty().escape(), (req, res) => {\n  const result = validationResult(req);\n  if (result.isEmpty()) {\n    return res.send(`Hello, ${req.query.person}!`);\n  }\n\n  res.send({ errors: result.array() });\n});\n\napp.listen(3000);\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:'Now, if you restart the server and refresh the page, what you\'ll see is "Hello, <b>John</b>!".\nOur example page is no longer vulnerable to XSS!'}),"\n",(0,s.jsx)(n.h2,{id:"accessing-validated-data",children:"Accessing validated data"}),"\n",(0,s.jsxs)(n.p,{children:["This application is pretty simple, but as you start growing it, it might become quite repetitive to\ntype ",(0,s.jsx)(n.code,{children:"req.body.fieldName1"}),", ",(0,s.jsx)(n.code,{children:"req.body.fieldName2"}),", and so on."]}),"\n",(0,s.jsxs)(n.p,{children:["To help with this, you can use ",(0,s.jsx)(n.a,{href:"/docs/next/api/matched-data",children:(0,s.jsx)(n.code,{children:"matchedData()"})}),", which automatically collects\nall data that express-validator has validated and/or sanitized:"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"lang",children:[(0,s.jsx)(i.Z,{value:"js",label:"JavaScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="index.js" showLineNumbers',children:"const express = require('express');\n// highlight-next-line\nconst { query, matchedData, validationResult } = require('express-validator');\nconst app = express();\n\napp.use(express.json());\napp.get('/hello', query('person').notEmpty().escape(), (req, res) => {\n  const result = validationResult(req);\n  if (result.isEmpty()) {\n    // highlight-next-line\n    const data = matchedData(req);\n    // highlight-next-line\n    return res.send(`Hello, ${data.person}!`);\n  }\n\n  res.send({ errors: result.array() });\n});\n\napp.listen(3000);\n"})})}),(0,s.jsx)(i.Z,{value:"ts",label:"TypeScript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="index.ts" showLineNumbers',children:"import * as express from 'express';\n// highlight-next-line\nimport { query, matchedData, validationResult } from 'express-validator';\nconst app = express();\n\napp.use(express.json());\napp.get('/hello', query('person').notEmpty().escape(), (req, res) => {\n  const result = validationResult(req);\n  if (result.isEmpty()) {\n    // highlight-next-line\n    const data = matchedData(req);\n    // highlight-next-line\n    return res.send(`Hello, ${data.person}!`);\n  }\n\n  res.send({ errors: result.array() });\n});\n\napp.listen(3000);\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"whats-next",children:"What's next?"}),"\n",(0,s.jsxs)(n.p,{children:["These steps conclude the basic guide on getting started with express-validator.",(0,s.jsx)("br",{}),"\nYou might want to continue reading about the other available features:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Learn about ",(0,s.jsx)(n.a,{href:"/docs/next/guides/validation-chain",children:"the validation chain"})]}),"\n",(0,s.jsxs)(n.li,{children:["Master the ",(0,s.jsx)(n.a,{href:"/docs/next/guides/field-selection",children:"field selection"})]}),"\n",(0,s.jsxs)(n.li,{children:["Deeply ",(0,s.jsx)(n.a,{href:"/docs/next/guides/customizing",children:"customize express-validator"})]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},9798:(e,n,t)=>{t.d(n,{Z:()=>i});t(7378);var s=t(624);const r={tabItem:"tabItem_wHwb"};var a=t(4246);function i(e){var n=e.children,t=e.hidden,i=e.className;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.Z)(r.tabItem,i),hidden:t,children:n})}},3930:(e,n,t)=>{t.d(n,{Z:()=>w});var s=t(7378),r=t(624),a=t(3457),i=t(3620),l=t(9834),o=t(654),d=t(784),u=t(1819);function c(e){var n,t;return null!=(n=null==(t=s.Children.toArray(e).filter((function(e){return"\n"!==e})).map((function(e){if(!e||(0,s.isValidElement)(e)&&((n=e.props)&&"object"==typeof n&&"value"in n))return e;var n;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function h(e){var n=e.values,t=e.children;return(0,s.useMemo)((function(){var e=null!=n?n:function(e){return c(e).map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes,default:n.default}}))}(t);return function(e){var n=(0,d.l)(e,(function(e,n){return e.value===n.value}));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function p(e){var n=e.value;return e.tabValues.some((function(e){return e.value===n}))}function x(e){var n=e.queryString,t=void 0!==n&&n,r=e.groupId,a=(0,i.k6)(),l=function(e){var n=e.queryString,t=void 0!==n&&n,s=e.groupId;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=s?s:null}({queryString:t,groupId:r});return[(0,o._X)(l),(0,s.useCallback)((function(e){if(l){var n=new URLSearchParams(a.location.search);n.set(l,e),a.replace(Object.assign({},a.location,{search:n.toString()}))}}),[l,a])]}function g(e){var n,t,r,a,i=e.defaultValue,o=e.queryString,d=void 0!==o&&o,c=e.groupId,g=h(e),m=(0,s.useState)((function(){return function(e){var n,t=e.defaultValue,s=e.tabValues;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:s}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+s.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}var r=null!=(n=s.find((function(e){return e.default})))?n:s[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:i,tabValues:g})})),v=m[0],j=m[1],f=x({queryString:d,groupId:c}),y=f[0],b=f[1],w=(n=function(e){return e?"docusaurus.tab."+e:null}({groupId:c}.groupId),t=(0,u.Nk)(n),r=t[0],a=t[1],[r,(0,s.useCallback)((function(e){n&&a.set(e)}),[n,a])]),q=w[0],N=w[1],S=function(){var e=null!=y?y:q;return p({value:e,tabValues:g})?e:null}();return(0,l.Z)((function(){S&&j(S)}),[S]),{selectedValue:v,selectValue:(0,s.useCallback)((function(e){if(!p({value:e,tabValues:g}))throw new Error("Can't select invalid tab value="+e);j(e),b(e),N(e)}),[b,N,g]),tabValues:g}}var m=t(6457);const v={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var j=t(4246);function f(e){var n=e.className,t=e.block,s=e.selectedValue,i=e.selectValue,l=e.tabValues,o=[],d=(0,a.o5)().blockElementScrollPositionUntilNextRender,u=function(e){var n=e.currentTarget,t=o.indexOf(n),r=l[t].value;r!==s&&(d(n),i(r))},c=function(e){var n,t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":var s,r=o.indexOf(e.currentTarget)+1;t=null!=(s=o[r])?s:o[0];break;case"ArrowLeft":var a,i=o.indexOf(e.currentTarget)-1;t=null!=(a=o[i])?a:o[o.length-1]}null==(n=t)||n.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n),children:l.map((function(e){var n=e.value,t=e.label,a=e.attributes;return(0,j.jsx)("li",Object.assign({role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:function(e){return o.push(e)},onKeyDown:c,onClick:u},a,{className:(0,r.Z)("tabs__item",v.tabItem,null==a?void 0:a.className,{"tabs__item--active":s===n}),children:null!=t?t:n}),n)}))})}function y(e){var n=e.lazy,t=e.children,r=e.selectedValue,a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){var i=a.find((function(e){return e.props.value===r}));return i?(0,s.cloneElement)(i,{className:"margin-top--md"}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:a.map((function(e,n){return(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r})}))})}function b(e){var n=g(e);return(0,j.jsxs)("div",{className:(0,r.Z)("tabs-container",v.tabList),children:[(0,j.jsx)(f,Object.assign({},e,n)),(0,j.jsx)(y,Object.assign({},e,n))]})}function w(e){var n=(0,m.Z)();return(0,j.jsx)(b,Object.assign({},e,{children:c(e.children)}),String(n))}},1670:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>i});var s=t(7378);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);